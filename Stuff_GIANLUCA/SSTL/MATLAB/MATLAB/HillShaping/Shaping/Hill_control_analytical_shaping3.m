function [F_r,F_u] = Hill_control_analytical_shaping3(F_n,dF_n,i,di,mu,p,u0,shape_flag)

if ( shape_flag == 0 )
    
    a0= p(1); a1= p(2); a2= p(3); a3 = p(4); a4 = p(5); a5 = p(6); a6=p(7);
    G0 = p(8); G1 = p(9); G2 = p(10); G3 = p(11);
    
    Control_x = @(u) mu ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* (cos(u) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) - sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3))) .* (0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (cos(u) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) - sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3))) .^ 2 + 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) + cos(u) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3))) .^ 2 + 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* sin(u) .^ 2 .* (0.1e1 - (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2)) .^ (-0.3e1 ./ 0.2e1) + (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 4 .* (0.2e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 3 .* (cos(u) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) - sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3))) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) .^ 2 - 0.2e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (-sin(u) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) - cos(u) .* (h1 + h2 .* cos(u - u0 + h3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) - cos(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) - sin(u) .* (H1 + H2 .* cos(u - u0 + H3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) - sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* (h1 + h2 .* cos(u - u0 + h3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) + sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (G1 + G2 .* cos(u - u0 + G3))) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (cos(u) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) - sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3))) .* (0.2e1 .* a2 - 0.2e1 .* a4 .* sin(u) - (a4 .* u + a3) .* cos(u) + 0.2e1 .* a6 .* cos(u) - (a6 .* u + a5) .* sin(u)) + 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* (-cos(u) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) + 0.2e1 .* sin(u) .* (h1 + h2 .* cos(u - u0 + h3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) + cos(u) .* h2 .* sin(u - u0 + h3) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) - cos(u) .* (h1 + h2 .* cos(u - u0 + h3)) .^ 2 .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) + sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) - 0.2e1 .* cos(u) .* (H1 + H2 .* cos(u - u0 + H3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) - 0.2e1 .* cos(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* (h1 + h2 .* cos(u - u0 + h3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) + 0.2e1 .* cos(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (G1 + G2 .* cos(u - u0 + G3)) + sin(u) .* H2 .* sin(u - u0 + H3) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) - 0.2e1 .* sin(u) .* (H1 + H2 .* cos(u - u0 + H3)) .* (h1 + h2 .* cos(u - u0 + h3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) + 0.2e1 .* sin(u) .* (H1 + H2 .* cos(u - u0 + H3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (G1 + G2 .* cos(u - u0 + G3)) + sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* h2 .* sin(u - u0 + h3) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) + sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* (h1 + h2 .* cos(u - u0 + h3)) .^ 2 .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) + 0.2e1 .* sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* (h1 + h2 .* cos(u - u0 + h3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (G1 + G2 .* cos(u - u0 + G3)) - 0.2e1 .* sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 3 .* (G1 + G2 .* cos(u - u0 + G3)) .^ 2 - sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* G2 .* sin(u - u0 + G3))) + (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* ((G1 + G2 .* cos(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 + 0.2e1 .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u))) .* (-0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (cos(u) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) - sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3))) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) + 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* (-sin(u) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) - cos(u) .* (h1 + h2 .* cos(u - u0 + h3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) - cos(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) - sin(u) .* (H1 + H2 .* cos(u - u0 + H3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) - sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* (h1 + h2 .* cos(u - u0 + h3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) + sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (G1 + G2 .* cos(u - u0 + G3))));
    
    Control_y = @(u) mu ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* (sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) + cos(u) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3))) .* (0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (cos(u) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) - sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3))) .^ 2 + 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) + cos(u) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3))) .^ 2 + 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* sin(u) .^ 2 .* (0.1e1 - (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2)) .^ (-0.3e1 ./ 0.2e1) + (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 4 .* (0.2e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 3 .* (sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) + cos(u) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3))) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) .^ 2 - 0.2e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (cos(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) + sin(u) .* (H1 + H2 .* cos(u - u0 + H3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) - sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* (h1 + h2 .* cos(u - u0 + h3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) - sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (G1 + G2 .* cos(u - u0 + G3)) - sin(u) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) + cos(u) .* (h1 + h2 .* cos(u - u0 + h3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3))) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) + cos(u) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3))) .* (0.2e1 .* a2 - 0.2e1 .* a4 .* sin(u) - (a4 .* u + a3) .* cos(u) + 0.2e1 .* a6 .* cos(u) - (a6 .* u + a5) .* sin(u)) + 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* (-sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) + 0.2e1 .* cos(u) .* (H1 + H2 .* cos(u - u0 + H3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) - 0.2e1 .* cos(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* (h1 + h2 .* cos(u - u0 + h3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) - 0.2e1 .* cos(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (G1 + G2 .* cos(u - u0 + G3)) - sin(u) .* H2 .* sin(u - u0 + H3) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) - 0.2e1 .* sin(u) .* (H1 + H2 .* cos(u - u0 + H3)) .* (h1 + h2 .* cos(u - u0 + h3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) - 0.2e1 .* sin(u) .* (H1 + H2 .* cos(u - u0 + H3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (G1 + G2 .* cos(u - u0 + G3)) + sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* h2 .* sin(u - u0 + h3) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) - sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* (h1 + h2 .* cos(u - u0 + h3)) .^ 2 .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) + 0.2e1 .* sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* (h1 + h2 .* cos(u - u0 + h3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (G1 + G2 .* cos(u - u0 + G3)) + 0.2e1 .* sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 3 .* (G1 + G2 .* cos(u - u0 + G3)) .^ 2 + sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* G2 .* sin(u - u0 + G3) - cos(u) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) - 0.2e1 .* sin(u) .* (h1 + h2 .* cos(u - u0 + h3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) - cos(u) .* h2 .* sin(u - u0 + h3) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) - cos(u) .* (h1 + h2 .* cos(u - u0 + h3)) .^ 2 .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)))) + (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* ((G1 + G2 .* cos(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 + 0.2e1 .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u))) .* (-0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) + cos(u) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3))) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) + 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* (cos(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) + sin(u) .* (H1 + H2 .* cos(u - u0 + H3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) - sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* (h1 + h2 .* cos(u - u0 + h3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) - sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (G1 + G2 .* cos(u - u0 + G3)) - sin(u) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) + cos(u) .* (h1 + h2 .* cos(u - u0 + h3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3))));
    
    Control_z = @(u) mu ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* sin(u) .* sqrt(0.1e1 - (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2) .* (0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (cos(u) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) - sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3))) .^ 2 + 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (sin(u) .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) + cos(u) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3))) .^ 2 + 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* sin(u) .^ 2 .* (0.1e1 - (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2)) .^ (-0.3e1 ./ 0.2e1) + (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 4 .* (0.2e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 3 .* sin(u) .* sqrt(0.1e1 - (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) .^ 2 - 0.2e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(u) .* sqrt(0.1e1 - (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* sin(u) .* (0.1e1 - (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2) .^ (-0.1e1 ./ 0.2e1) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) .* (-0.2e1 .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (H1 + H2 .* cos(u - u0 + H3)) + 0.2e1 .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 3 .* (G1 + G2 .* cos(u - u0 + G3))) - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* sin(u) .* sqrt(0.1e1 - (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2) .* (0.2e1 .* a2 - 0.2e1 .* a4 .* sin(u) - (a4 .* u + a3) .* cos(u) + 0.2e1 .* a6 .* cos(u) - (a6 .* u + a5) .* sin(u)) - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* sin(u) .* sqrt(0.1e1 - (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2) + 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* cos(u) .* (0.1e1 - (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2) .^ (-0.1e1 ./ 0.2e1) .* (-0.2e1 .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (H1 + H2 .* cos(u - u0 + H3)) + 0.2e1 .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 3 .* (G1 + G2 .* cos(u - u0 + G3))) - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* sin(u) .* (0.1e1 - (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2) .^ (-0.3e1 ./ 0.2e1) .* (-0.2e1 .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (H1 + H2 .* cos(u - u0 + H3)) + 0.2e1 .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 3 .* (G1 + G2 .* cos(u - u0 + G3))) .^ 2 ./ 0.4e1 + 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* sin(u) .* (0.1e1 - (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2) .^ (-0.1e1 ./ 0.2e1) .* (-0.2e1 .* (H1 + H2 .* cos(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 + 0.8e1 .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 3 .* (H1 + H2 .* cos(u - u0 + H3)) .* (G1 + G2 .* cos(u - u0 + G3)) + 0.2e1 .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* H2 .* sin(u - u0 + H3) - 0.6e1 .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 4 .* (G1 + G2 .* cos(u - u0 + G3)) .^ 2 - 0.2e1 .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 3 .* G2 .* sin(u - u0 + G3)) ./ 0.2e1) + (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* ((G1 + G2 .* cos(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 + 0.2e1 .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u))) .* (-0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* sin(u) .* sqrt(0.1e1 - (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) + 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* cos(u) .* sqrt(0.1e1 - (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2) + 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* sin(u) .* (0.1e1 - (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2) .^ (-0.1e1 ./ 0.2e1) .* (-0.2e1 .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (H1 + H2 .* cos(u - u0 + H3)) + 0.2e1 .* (H0 + H1 .* (u - u0) + H2 .* sin(u - u0 + H3)) .^ 2 ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 3 .* (G1 + G2 .* cos(u - u0 + G3))) ./ 0.2e1);

elseif ( shape_flag == 1 )
    
    a0= p(1); a1= p(2); a2= p(3); a3 = p(4); a4 = p(5); a5 = p(6); a6=p(7);
    G0 = p(8); G1 = p(9); G2 = p(10); G3 = p(11);
%     
%     Control_x = @(u) (cos(u) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) - sin(u) .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3))) .* (mu .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 3 + (0.2e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 3 .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) .^ 2 .* ((G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3))) - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (0.2e1 .* a2 - 0.2e1 .* a4 .* sin(u) - (a4 .* u + a3) .* cos(u) + 0.2e1 .* a6 .* cos(u) - (a6 .* u + a5) .* sin(u)) .* ((G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3))) - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) .* ((G1 + G2 .* cos(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 + 0.2e1 .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) - 0.2e1 .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) + (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (i1 + i2 .* cos(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) - (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* cos(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) - (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (-i2 .* sin(u - u0 + i3) - h2 .* sin(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) - (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G1 + G2 .* cos(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) .^ 2 ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (cos(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) - sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .^ 2 .* (i1 + i2 .* cos(u - u0 + i3)) .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) - sin(u) + cos(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) - sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .^ 2 .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (i1 + i2 .* cos(u - u0 + i3)) .* (0.1e1 + tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .^ 2) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (-i2 .* sin(u - u0 + i3) - h2 .* sin(u - u0 + h3))) + (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .^ 2 .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .^ 2 .* (i1 + i2 .* cos(u - u0 + i3)))) .* ((G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)))) + (-sin(u) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) - cos(u) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3))) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* ((G1 + G2 .* cos(u - u0 + G3)) .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) - (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (i1 + i2 .* cos(u - u0 + i3)) .* sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3))) .* ((G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3))) + sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) .* sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 3 ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)));
% 
%     Control_y = @(u) (sin(u) .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) + cos(u) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3))) .* (mu .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 3 + (0.2e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 3 .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) .^ 2 .* ((G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3))) - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (0.2e1 .* a2 - 0.2e1 .* a4 .* sin(u) - (a4 .* u + a3) .* cos(u) + 0.2e1 .* a6 .* cos(u) - (a6 .* u + a5) .* sin(u)) .* ((G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3))) - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) .* ((G1 + G2 .* cos(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 + 0.2e1 .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) - 0.2e1 .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) + (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (i1 + i2 .* cos(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) - (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* cos(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) - (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (-i2 .* sin(u - u0 + i3) - h2 .* sin(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) - (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G1 + G2 .* cos(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) .^ 2 ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (cos(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) - sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .^ 2 .* (i1 + i2 .* cos(u - u0 + i3)) .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) - sin(u) + cos(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) - sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .^ 2 .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (i1 + i2 .* cos(u - u0 + i3)) .* (0.1e1 + tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .^ 2) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (-i2 .* sin(u - u0 + i3) - h2 .* sin(u - u0 + h3))) + (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .^ 2 .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .^ 2 .* (i1 + i2 .* cos(u - u0 + i3)))) .* ((G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)))) + (-sin(u) .* sin(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) + cos(u) .* cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3))) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* ((G1 + G2 .* cos(u - u0 + G3)) .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) - (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (i1 + i2 .* cos(u - u0 + i3)) .* sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3))) .* ((G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3))) - cos(h0 + h1 .* (u - u0) + h2 .* sin(u - u0 + h3)) .* sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 3 ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)));
% 
%     Control_z = @(u) sin(u) .* sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (mu .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 3 + (0.2e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 3 .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) .^ 2 .* ((G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3))) - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (0.2e1 .* a2 - 0.2e1 .* a4 .* sin(u) - (a4 .* u + a3) .* cos(u) + 0.2e1 .* a6 .* cos(u) - (a6 .* u + a5) .* sin(u)) .* ((G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3))) - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) .* ((G1 + G2 .* cos(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 + 0.2e1 .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) - 0.2e1 .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) + (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (i1 + i2 .* cos(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) - (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* cos(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) - (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (-i2 .* sin(u - u0 + i3) - h2 .* sin(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) - (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G1 + G2 .* cos(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) .^ 2 ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (cos(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) - sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .^ 2 .* (i1 + i2 .* cos(u - u0 + i3)) .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) - sin(u) + cos(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) - sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .^ 2 .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (i1 + i2 .* cos(u - u0 + i3)) .* (0.1e1 + tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .^ 2) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (-i2 .* sin(u - u0 + i3) - h2 .* sin(u - u0 + h3))) + (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .^ 2 .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .^ 2 .* (i1 + i2 .* cos(u - u0 + i3)))) .* ((G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)))) + cos(u) .* sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* ((G1 + G2 .* cos(u - u0 + G3)) .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) - (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (i1 + i2 .* cos(u - u0 + i3)) .* sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3))) .* ((G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* sin(u) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3))) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3))) + cos(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)) .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 3 ./ (sin(u) ./ sin(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) + cos(u) + sin(u) ./ tan(i0 + i1 .* (u - u0) + i2 .* sin(u - u0 + i3)) .* (i1 + i2 .* cos(u - u0 + i3) + h1 + h2 .* cos(u - u0 + h3)));

%         F_r = @(u) ((G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* cot(i(u)) .* sin(u) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* F_n(u)) .* (-((G1 + G2 .* cos(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 + 0.2e1 .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) + 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cot(i(u)) .* sin(u) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* F_n(u) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* di(u) .* (-0.1e1 - cot(i(u)) .^ 2) .* sin(u) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* F_n(u) - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* cot(i(u)) .* cos(u) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* F_n(u) + 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* cot(i(u)) .* sin(u) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* F_n(u) .* (G1 + G2 .* cos(u - u0 + G3)) - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* cot(i(u)) .* sin(u) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* dF_n(u)) ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) + 0.2e1 .* ((G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* cot(i(u)) .* sin(u) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* F_n(u)) ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 3 .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) .^ 2 - ((G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* cot(i(u)) .* sin(u) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* F_n(u)) ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (0.2e1 .* a2 - 0.2e1 .* a4 .* sin(u) - (a4 .* u + a3) .* cos(u) + 0.2e1 .* a6 .* cos(u) - (a6 .* u + a5) .* sin(u))) + mu .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 3;

%         F_r = @(u) ((G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* cot(i(u)) .* sin(u) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* F_n(u)) .* (-(G1 + G2 .* cos(u - u0 + G3)) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) - (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (0.2e1 .* a2 - 0.2e1 .* a4 .* sin(u) - (a4 .* u + a3) .* cos(u) + 0.2e1 .* a6 .* cos(u) - (a6 .* u + a5) .* sin(u))) + mu .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 3;

        F_r = @(u) mu .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 3 + ((G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* cot(i(u)) .* sin(u) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* F_n(u)) .* (-((G1 + G2 .* cos(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 + 0.2e1 .* (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) + 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* cot(i(u)) .* sin(u) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* F_n(u) .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* di(u) .* (-0.1e1 - cot(i(u)) .^ 2) .* sin(u) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* F_n(u) - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* cot(i(u)) .* cos(u) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* F_n(u) + 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* cot(i(u)) .* sin(u) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .^ 2 .* F_n(u) .* (G1 + G2 .* cos(u - u0 + G3)) - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* cot(i(u)) .* sin(u) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* dF_n(u)) ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) + 0.2e1 .* ((G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* cot(i(u)) .* sin(u) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* F_n(u)) ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 3 .* (a1 + 0.2e1 .* a2 .* u + a4 .* cos(u) - (a4 .* u + a3) .* sin(u) + a6 .* sin(u) + (a6 .* u + a5) .* cos(u)) .^ 2 - ((G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* cot(i(u)) .* sin(u) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* F_n(u)) ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 .* (0.2e1 .* a2 - 0.2e1 .* a4 .* sin(u) - (a4 .* u + a3) .* cos(u) + 0.2e1 .* a6 .* cos(u) - (a6 .* u + a5) .* sin(u)));

        F_u = @(u) (G1 + G2 .* cos(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* ((G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)) .* (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .^ 2 - 0.1e1 ./ (a0 + a1 .* u + a2 .* u .^ 2 + (a4 .* u + a3) .* cos(u) + (a6 .* u + a5) .* sin(u)) .* cot(i(u)) .* sin(u) .* F_n(u) ./ (G0 + G1 .* (u - u0) + G2 .* sin(u - u0 + G3)));

    
end

end
function Objective = Pseudo_Shaping_Obj(y,LVec,LStep,A,b,mu,Lin_Trig,Analytic_VA,t_dep,TOF,toll)
%
% Pseudo_Shaping_Obj: objective function for the Pseudo Shaping. Objective is
% DeltaV
%
%
% INPUT
% y: parameters from the optimizer (free parameters)
% LVec: vector with angle L of the trajectory
% LStep: step of angle L of trajectory
% A: matrix of the linear system to be solved
% b: known vector of boundary conditions of the linear system
% mu: gravitational parameter
% Lin_Trig: flag to select if to use Linear Trigonometric form or
% exponential form
% Analytic_VA: flag to select if to compute velocity and acceleration with
% analytic formulas or numerical
% t_dep: departure time
% TOF: time of flight
% toll: tolerance

% OUTPUT
% objective: DeltaV
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Niccolo' Gastaldello, February 2015
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Compute the objective function (the DV)

%--------------------------------------------------------------------------
% Extract lambda
%--------------------------------------------------------------------------
l1 = y(1);
l2 = y(2);
l3 = y(3);

%--------------------------------------------------------------------------
% Extract L0,Lf
%--------------------------------------------------------------------------
L0 = LVec(1);
L_f = LVec(end);
dL = L_f - L0;

if Lin_Trig
    %--------------------------------------------------------------------------
    % Build the vector c
    %--------------------------------------------------------------------------
    c = [0;
         l1*sin(dL);
         0;
         l2*sin(dL);
         l2;
         l2*cos(dL);
         0
         l3*sin(dL);
         l3;
         l3*cos(dL)];
    
else
    %--------------------------------------------------------------------------
    % Build the matrix A
    %--------------------------------------------------------------------------
    A = [1 1 0 0 0 0 0 0 0 0;
         1 exp(l1*dL) 0 0 0 0 0 0 0 0;
         0 0 1 1 0 0 0 0 0 0;
         0 0 1 exp(l2*dL) 0 0 0 0 0 0;
         0 0 0 0 1 1 0 0 0 0;
         0 0 0 0 1 exp(l2*dL) 0 0 0 0;
         0 0 0 0 0 0 1 1 0 0;
         0 0 0 0 0 0 1 exp(l3*dL) 0 0;
         0 0 0 0 0 0 0 0 1 1;
         0 0 0 0 0 0 0 0 1 exp(l3*dL)];
    
    c = 0;
end

%--------------------------------------------------------------------------
% Solve for x
%--------------------------------------------------------------------------
x = A\(b-c);

%--------------------------------------------------------------------------
% Find the matrix with the Pseudo elements
%--------------------------------------------------------------------------
Pseudo_Matrix = Pseudo_Shaped(y,LVec,x,Lin_Trig);

% Extract the elements
p = Pseudo_Matrix(:,1);
f = Pseudo_Matrix(:,2);
g = Pseudo_Matrix(:,3);
h = Pseudo_Matrix(:,4);
k = Pseudo_Matrix(:,5);

%--------------------------------------------------------------------------
% Calculate time derivative of L
%--------------------------------------------------------------------------
q = (1 + f.*cos(LVec) + g.*sin(LVec));
rr = p./q;
LDot = sqrt(mu*p).*(1./rr).^2;
TPrime = 1./LDot;

%--------------------------------------------------------------------------
% Calculate time evolution
%--------------------------------------------------------------------------
[timeVec1] = timeEvolution(LVec,TPrime,t_dep);
timeVec1 = timeVec1';

%--------------------------------------------------------------------------
% Compute the position vector in Cartesian coordinates
%--------------------------------------------------------------------------
Rx = (rr./(1+h.^2+k.^2)).*(cos(LVec) + (h.^2 - k.^2).*cos(LVec) + 2*h.*k.*sin(LVec));
Ry = (rr./(1+h.^2+k.^2)).*(sin(LVec) - (h.^2 - k.^2).*sin(LVec) + 2*h.*k.*cos(LVec));
Rz = (2*rr./(1+h.^2+k.^2)).*(h.*sin(LVec) - k.*cos(LVec));
Rr(:,1) = Rx;
Rr(:,2) = Ry;
Rr(:,3) = Rz;
RMod = sqrt( Rx.^2 + Ry.^2 + Rz.^2 );


%--------------------------------------------------------------------------
% Compute velocity,acceleration vectors in Cartesian coordinates
%--------------------------------------------------------------------------

if Analytic_VA
    
    % Extract parameters alpha_1
    p1 = x(2);
    f1 = x(4);
    g1 = x(6);
    h1 = x(8);
    k1 = x(10);
    
    L = LVec;
    
    % Analytic formulas from Maple (uncomment to select them)
    % It was not possible to simplify them, the expressions are really long
%     if Lin_Trig
%         
%         Accx = (((-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) - 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) + (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* h + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L))) .* (h1 + l3 .* cos(L - L0)) + (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* k + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L))) .* (k1 - l3 .* sin(L - L0)) - 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L))) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2 + (0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (p1 + l1 .* cos(L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) + (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* h + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L))) .* (h1 + l3 .* cos(L - L0)) + (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* k + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L))) .* (k1 - l3 .* sin(L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L))) .* (mu .* p) .^ (-0.1e1 ./ 0.2e1) .* q .^ 2 ./ p .^ 2 .* mu ./ 0.2e1 - 0.2e1 .* (0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (p1 + l1 .* cos(L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) + (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* h + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L))) .* (h1 + l3 .* cos(L - L0)) + (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* k + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L))) .* (k1 - l3 .* sin(L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L))) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 3) .* (p1 + l1 .* cos(L - L0)) + (-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (p1 + l1 .* cos(L - L0)) .* cos(L) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) .^ 2 .* (f1 + l2 .* cos(L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) .* cos(L) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* h .* cos(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* cos(L)) .* (h1 + l3 .* cos(L - L0)) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* k .* cos(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* cos(L)) .* (k1 - l3 .* sin(L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) .* cos(L) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L)) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2 .* (f1 + l2 .* cos(L - L0)) + (-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (p1 + l1 .* cos(L - L0)) .* sin(L) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) .* sin(L) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) .^ 2 .* (g1 - l2 .* sin(L - L0)) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* h .* sin(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* sin(L)) .* (h1 + l3 .* cos(L - L0)) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* k .* sin(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* sin(L)) .* (k1 - l3 .* sin(L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) .* sin(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L)) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2 .* (g1 - l2 .* sin(L - L0)) + (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (p1 + l1 .* cos(L - L0)) .* h + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* (p1 + l1 .* cos(L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) .* h - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) .* h - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) + (0.8e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (h .^ 2) - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L)) .* (h1 + l3 .* cos(L - L0)) + (0.8e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* k .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* h + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L)) .* (k1 - l3 .* sin(L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) .* h - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* h + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L))) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2 .* (h1 + l3 .* cos(L - L0)) + (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (p1 + l1 .* cos(L - L0)) .* k + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* (p1 + l1 .* cos(L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) .* k - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) .* k - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) + (0.8e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* k .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* h + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L)) .* (h1 + l3 .* cos(L - L0)) + (0.8e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (k .^ 2) - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L)) .* (k1 - l3 .* sin(L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) .* k - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* k + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L))) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2 .* (k1 - l3 .* sin(L - L0)) + (-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (p1 + l1 .* cos(L - L0)) .* (-f .* sin(L) + g .* cos(L)) + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (p1 + l1 .* cos(L - L0)) - 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* l1 .* sin(L - L0) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) .* (-f .* sin(L) + g .* cos(L)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) .* (f1 + l2 .* cos(L - L0)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) .* l2 .* sin(L - L0) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) .* (-f .* sin(L) + g .* cos(L)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) .* (g1 - l2 .* sin(L - L0)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) .* l2 .* cos(L - L0) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* h - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L))) .* (h1 + l3 .* cos(L - L0)) - (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* h + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L))) .* l3 .* sin(L - L0) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* k - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L))) .* (k1 - l3 .* sin(L - L0)) - (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* k + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L))) .* l3 .* cos(L - L0) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) .^ 2 - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* cos(L) - g .* sin(L)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L))) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2;
%         Accy = (((-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) - 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) + (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* h + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L))) .* (h1 + l3 .* cos(L - L0)) + (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* k + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L))) .* (k1 - l3 .* sin(L - L0)) - 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L))) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2 + (0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (p1 + l1 .* cos(L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) + (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* h + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L))) .* (h1 + l3 .* cos(L - L0)) + (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* k + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L))) .* (k1 - l3 .* sin(L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L))) .* (mu .* p) .^ (-0.1e1 ./ 0.2e1) .* q .^ 2 ./ p .^ 2 .* mu ./ 0.2e1 - 0.2e1 .* (0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (p1 + l1 .* cos(L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) + (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* h + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L))) .* (h1 + l3 .* cos(L - L0)) + (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* k + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L))) .* (k1 - l3 .* sin(L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L))) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 3) .* (p1 + l1 .* cos(L - L0)) + (-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (p1 + l1 .* cos(L - L0)) .* cos(L) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .^ 2 .* (f1 + l2 .* cos(L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) .* cos(L) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* h .* cos(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L)) .* cos(L)) .* (h1 + l3 .* cos(L - L0)) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* k .* cos(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* cos(L)) .* (k1 - l3 .* sin(L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* cos(L) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L)) .* cos(L)) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2 .* (f1 + l2 .* cos(L - L0)) + (-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (p1 + l1 .* cos(L - L0)) .* sin(L) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) .* sin(L) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .^ 2 .* (g1 - l2 .* sin(L - L0)) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* h .* sin(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L)) .* sin(L)) .* (h1 + l3 .* cos(L - L0)) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* k .* sin(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* sin(L)) .* (k1 - l3 .* sin(L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* sin(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L)) .* sin(L)) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2 .* (g1 - l2 .* sin(L - L0)) + (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (p1 + l1 .* cos(L - L0)) .* h + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L)) .* (p1 + l1 .* cos(L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) .* h - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) .* h - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) + (0.8e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (h .^ 2) - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L)) .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L)) .* (h1 + l3 .* cos(L - L0)) + (0.8e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* k .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* h + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L)) .* (k1 - l3 .* sin(L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* h - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L)) .* h + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* cos(L) - 0.2e1 .* k .* sin(L))) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2 .* (h1 + l3 .* cos(L - L0)) + (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (p1 + l1 .* cos(L - L0)) .* k + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* (p1 + l1 .* cos(L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) .* k - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) .* k - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) + (0.8e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* k .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* h + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L)) .* (h1 + l3 .* cos(L - L0)) + (0.8e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (k .^ 2) - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L)) .* (k1 - l3 .* sin(L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* k - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L)) .* k + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L))) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2 .* (k1 - l3 .* sin(L - L0)) + (-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (p1 + l1 .* cos(L - L0)) .* (-f .* sin(L) + g .* cos(L)) + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L)) .* (p1 + l1 .* cos(L - L0)) - 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* l1 .* sin(L - L0) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) .* (-f .* sin(L) + g .* cos(L)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .* (f1 + l2 .* cos(L - L0)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .* l2 .* sin(L - L0) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) .* (-f .* sin(L) + g .* cos(L)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .* (g1 - l2 .* sin(L - L0)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .* l2 .* cos(L - L0) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L)) .* h - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* cos(L) - 0.2e1 .* k .* sin(L))) .* (h1 + l3 .* cos(L - L0)) - (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* h + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L))) .* l3 .* sin(L - L0) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L)) .* k - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L))) .* (k1 - l3 .* sin(L - L0)) - (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* k + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L))) .* l3 .* cos(L - L0) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .^ 2 - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* cos(L) - g .* sin(L)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-sin(L) + (h .^ 2 - k .^ 2) .* sin(L) - 0.2e1 .* h .* k .* cos(L))) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2;
%         Accz = ((-0.2e1 ./ p .^ 3 .* (0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* (p1 + l1 .* cos(L - L0)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) + (-0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* h + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L)) .* (h1 + l3 .* cos(L - L0)) + (-0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L)) .* (k1 - l3 .* sin(L - L0)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (h .* cos(L) + k .* sin(L))) .* sqrt(mu .* p) .* q .^ 2 + 0.1e1 ./ p .^ 2 .* (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) - 0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) + (-0.4e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* h + 0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L)) .* (h1 + l3 .* cos(L - L0)) + (-0.4e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* k - 0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L)) .* (k1 - l3 .* sin(L - L0)) - 0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) + 0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (h .* cos(L) + k .* sin(L))) .* sqrt(mu .* p) .* q .^ 2 + 0.1e1 ./ p .^ 2 .* (0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* (p1 + l1 .* cos(L - L0)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) + (-0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* h + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L)) .* (h1 + l3 .* cos(L - L0)) + (-0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L)) .* (k1 - l3 .* sin(L - L0)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (h .* cos(L) + k .* sin(L))) .* (mu .* p) .^ (-0.1e1 ./ 0.2e1) .* q .^ 2 .* mu ./ 0.2e1) .* (p1 + l1 .* cos(L - L0)) + 0.1e1 ./ p .^ 2 .* (-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* (p1 + l1 .* cos(L - L0)) .* cos(L) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* cos(L) .^ 2 .* (f1 + l2 .* cos(L - L0)) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) .* cos(L) + (0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* h .* cos(L) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* sin(L) .* cos(L)) .* (h1 + l3 .* cos(L - L0)) + (0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* k .* cos(L) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* cos(L) .^ 2) .* (k1 - l3 .* sin(L - L0)) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* cos(L) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* sin(L) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* cos(L) + k .* sin(L)) .* cos(L)) .* sqrt(mu .* p) .* q .^ 2 .* (f1 + l2 .* cos(L - L0)) + 0.1e1 ./ p .^ 2 .* (-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* (p1 + l1 .* cos(L - L0)) .* sin(L) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) .* sin(L) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* sin(L) .^ 2 .* (g1 - l2 .* sin(L - L0)) + (0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* h .* sin(L) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* sin(L) .^ 2) .* (h1 + l3 .* cos(L - L0)) + (0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* k .* sin(L) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* sin(L) .* cos(L)) .* (k1 - l3 .* sin(L - L0)) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* sin(L) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* cos(L) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* cos(L) + k .* sin(L)) .* sin(L)) .* sqrt(mu .* p) .* q .^ 2 .* (g1 - l2 .* sin(L - L0)) + 0.1e1 ./ p .^ 2 .* (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* (p1 + l1 .* cos(L - L0)) .* h + 0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L) .* (p1 + l1 .* cos(L - L0)) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* sin(L) .* cos(L) .* (f1 + l2 .* cos(L - L0)) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* sin(L) .^ 2 .* (g1 - l2 .* sin(L - L0)) + (0.16e2 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (h .* sin(L) - k .* cos(L)) .* (h .^ 2) - 0.8e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* sin(L) .* h - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L))) .* (h1 + l3 .* cos(L - L0)) + (0.16e2 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (h .* sin(L) - k .* cos(L)) .* k .* h - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* sin(L) .* k + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* cos(L) .* h) .* (k1 - l3 .* sin(L - L0)) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* sin(L) .* (-f .* sin(L) + g .* cos(L)) - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* cos(L) + k .* sin(L)) .* h + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L)) .* sqrt(mu .* p) .* q .^ 2 .* (h1 + l3 .* cos(L - L0)) + 0.1e1 ./ p .^ 2 .* (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* (p1 + l1 .* cos(L - L0)) .* k - 0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L) .* (p1 + l1 .* cos(L - L0)) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) .* k + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* cos(L) .^ 2 .* (f1 + l2 .* cos(L - L0)) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) .* k + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* cos(L) .* sin(L) .* (g1 - l2 .* sin(L - L0)) + (0.16e2 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (h .* sin(L) - k .* cos(L)) .* k .* h - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* sin(L) .* k + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* cos(L) .* h) .* (h1 + l3 .* cos(L - L0)) + (0.16e2 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (h .* sin(L) - k .* cos(L)) .* (k .^ 2) + 0.8e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* cos(L) .* k - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L))) .* (k1 - l3 .* sin(L - L0)) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* k + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* cos(L) .* (-f .* sin(L) + g .* cos(L)) - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* cos(L) + k .* sin(L)) .* k + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L)) .* sqrt(mu .* p) .* q .^ 2 .* (k1 - l3 .* sin(L - L0)) + 0.1e1 ./ p .^ 2 .* (-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* (p1 + l1 .* cos(L - L0)) .* (-f .* sin(L) + g .* cos(L)) + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* (p1 + l1 .* cos(L - L0)) - 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* l1 .* sin(L - L0) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) .* (-f .* sin(L) + g .* cos(L)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* cos(L) + k .* sin(L)) .* cos(L) .* (f1 + l2 .* cos(L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* sin(L) .* (f1 + l2 .* cos(L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* cos(L) .* l2 .* sin(L - L0) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) .* (-f .* sin(L) + g .* cos(L)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* cos(L) + k .* sin(L)) .* sin(L) .* (g1 - l2 .* sin(L - L0)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* cos(L) .* (g1 - l2 .* sin(L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* sin(L) .* l2 .* cos(L - L0) + (0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* h - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* cos(L) + k .* sin(L)) .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* sin(L) .* (-f .* sin(L) + g .* cos(L)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L)) .* (h1 + l3 .* cos(L - L0)) - (-0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* h + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L)) .* l3 .* sin(L - L0) + (0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* k - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* cos(L) + k .* sin(L)) .* k + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* cos(L) .* (-f .* sin(L) + g .* cos(L)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L)) .* (k1 - l3 .* sin(L - L0)) - (-0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L)) .* l3 .* cos(L - L0) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .^ 2 - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* cos(L) + k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* (-f .* cos(L) - g .* sin(L)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-h .* sin(L) + k .* cos(L))) .* sqrt(mu .* p) .* q .^ 2) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2;
%         
%         Acc(:,1) =  Accx;
%         Acc(:,2) =  Accy;
%         Acc(:,3) =  Accz;
%              
%     else
%         
%         Accx = (((-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) - 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) + (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* h + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L))) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* k + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L))) .* l3 .* k1 .* exp(l3 .* (L - L0)) - 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L))) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2 + (0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) + (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* h + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L))) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* k + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L))) .* l3 .* k1 .* exp(l3 .* (L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L))) .* (mu .* p) .^ (-0.1e1 ./ 0.2e1) .* q .^ 2 ./ p .^ 2 .* mu ./ 0.2e1 - 0.2e1 .* (0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) + (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* h + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L))) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* k + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L))) .* l3 .* k1 .* exp(l3 .* (L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L))) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 3) .* l1 .* p1 .* exp(l1 .* (L - L0)) + (-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) .* cos(L) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) .^ 2 .* l2 .* f1 .* exp(l2 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) .* cos(L) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* h .* cos(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* cos(L)) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* k .* cos(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* cos(L)) .* l3 .* k1 .* exp(l3 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) .* cos(L) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L)) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2 .* l2 .* f1 .* exp(l2 .* (L - L0)) + (-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) .* sin(L) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) .* sin(L) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) .^ 2 .* l2 .* g1 .* exp(l2 .* (L - L0)) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* h .* sin(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* sin(L)) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* k .* sin(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* sin(L)) .* l3 .* k1 .* exp(l3 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) .* sin(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L)) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2 .* l2 .* g1 .* exp(l2 .* (L - L0)) + (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) .* h + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) .* h - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) .* h - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) + (0.8e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (h .^ 2) - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L)) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (0.8e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* k .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* h + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L)) .* l3 .* k1 .* exp(l3 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) .* h - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* h + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L))) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2 .* l3 .* h1 .* exp(l3 .* (L - L0)) + (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) .* k + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) .* k - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) .* k - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) + (0.8e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* k .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* h + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L)) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (0.8e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (k .^ 2) - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L)) .* l3 .* k1 .* exp(l3 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) .* k - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* k + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L))) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2 .* l3 .* k1 .* exp(l3 .* (L - L0)) + (-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) .* (-f .* sin(L) + g .* cos(L)) + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* l1 .^ 2 .* p1 .* exp(l1 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) .* (-f .* sin(L) + g .* cos(L)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) .* l2 .^ 2 .* f1 .* exp(l2 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) .* (-f .* sin(L) + g .* cos(L)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* cos(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* sin(L) .* l2 .^ 2 .* g1 .* exp(l2 .* (L - L0)) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* h - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L))) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* h + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L))) .* l3 .^ 2 .* h1 .* exp(l3 .* (L - L0)) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* k - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L))) .* l3 .* k1 .* exp(l3 .* (L - L0)) + (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* k + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L))) .* l3 .^ 2 .* k1 .* exp(l3 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) .^ 2 - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) + (h .^ 2 - k .^ 2) .* cos(L) + 0.2e1 .* h .* k .* sin(L)) .* (-f .* cos(L) - g .* sin(L)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L))) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2;
%         Accy = (((-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) - 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) + (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* h + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L))) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* k + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L))) .* l3 .* k1 .* exp(l3 .* (L - L0)) - 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L))) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2 + (0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) + (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* h + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L))) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* k + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L))) .* l3 .* k1 .* exp(l3 .* (L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L))) .* (mu .* p) .^ (-0.1e1 ./ 0.2e1) .* q .^ 2 ./ p .^ 2 .* mu ./ 0.2e1 - 0.2e1 .* (0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) + (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* h + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L))) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* k + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L))) .* l3 .* k1 .* exp(l3 .* (L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L))) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 3) .* l1 .* p1 .* exp(l1 .* (L - L0)) + (-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) .* cos(L) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .^ 2 .* l2 .* f1 .* exp(l2 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) .* cos(L) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* h .* cos(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L)) .* cos(L)) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* k .* cos(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* cos(L)) .* l3 .* k1 .* exp(l3 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* cos(L) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L)) .* cos(L)) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2 .* l2 .* f1 .* exp(l2 .* (L - L0)) + (-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) .* sin(L) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) .* sin(L) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .^ 2 .* l2 .* g1 .* exp(l2 .* (L - L0)) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* h .* sin(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L)) .* sin(L)) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* k .* sin(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* sin(L)) .* l3 .* k1 .* exp(l3 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* sin(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L)) .* sin(L)) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2 .* l2 .* g1 .* exp(l2 .* (L - L0)) + (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) .* h + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) .* h - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) .* h - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) + (0.8e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (h .^ 2) - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L)) .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L)) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (0.8e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* k .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* h + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L)) .* l3 .* k1 .* exp(l3 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* h - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L)) .* h + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* cos(L) - 0.2e1 .* k .* sin(L))) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2 .* l3 .* h1 .* exp(l3 .* (L - L0)) + (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) .* k + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) .* k - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) .* k - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) + (0.8e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* k .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* h + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L)) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (0.8e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (k .^ 2) - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L)) .* l3 .* k1 .* exp(l3 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* k - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L)) .* k + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L))) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2 .* l3 .* k1 .* exp(l3 .* (L - L0)) + (-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) .* (-f .* sin(L) + g .* cos(L)) + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* l1 .^ 2 .* p1 .* exp(l1 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) .* (-f .* sin(L) + g .* cos(L)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .* l2 .^ 2 .* f1 .* exp(l2 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) .* (-f .* sin(L) + g .* cos(L)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* cos(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* sin(L) .* l2 .^ 2 .* g1 .* exp(l2 .* (L - L0)) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L)) .* h - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* cos(L) - 0.2e1 .* k .* sin(L))) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* h + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L))) .* l3 .^ 2 .* h1 .* exp(l3 .* (L - L0)) + (0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L)) .* k - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* h .* sin(L) + 0.2e1 .* k .* cos(L))) .* l3 .* k1 .* exp(l3 .* (L - L0)) + (-0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* k + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L))) .* l3 .^ 2 .* k1 .* exp(l3 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .^ 2 - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (cos(L) - (h .^ 2 - k .^ 2) .* cos(L) - 0.2e1 .* h .* k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) - p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (sin(L) - (h .^ 2 - k .^ 2) .* sin(L) + 0.2e1 .* h .* k .* cos(L)) .* (-f .* cos(L) - g .* sin(L)) + p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-sin(L) + (h .^ 2 - k .^ 2) .* sin(L) - 0.2e1 .* h .* k .* cos(L))) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2;
%         Accz = ((-0.2e1 ./ p .^ 3 .* (0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) + (-0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* h + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L)) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (-0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L)) .* l3 .* k1 .* exp(l3 .* (L - L0)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (h .* cos(L) + k .* sin(L))) .* sqrt(mu .* p) .* q .^ 2 + 0.1e1 ./ p .^ 2 .* (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) - 0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) + (-0.4e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* h + 0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L)) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (-0.4e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* k - 0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L)) .* l3 .* k1 .* exp(l3 .* (L - L0)) - 0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) + 0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (h .* cos(L) + k .* sin(L))) .* sqrt(mu .* p) .* q .^ 2 + 0.1e1 ./ p .^ 2 .* (0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) + (-0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* h + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L)) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (-0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L)) .* l3 .* k1 .* exp(l3 .* (L - L0)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (h .* cos(L) + k .* sin(L))) .* (mu .* p) .^ (-0.1e1 ./ 0.2e1) .* q .^ 2 .* mu ./ 0.2e1) .* l1 .* p1 .* exp(l1 .* (L - L0)) + 0.1e1 ./ p .^ 2 .* (-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) .* cos(L) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* cos(L) .^ 2 .* l2 .* f1 .* exp(l2 .* (L - L0)) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) .* cos(L) + (0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* h .* cos(L) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* sin(L) .* cos(L)) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* k .* cos(L) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* cos(L) .^ 2) .* l3 .* k1 .* exp(l3 .* (L - L0)) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* cos(L) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* sin(L) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* cos(L) + k .* sin(L)) .* cos(L)) .* sqrt(mu .* p) .* q .^ 2 .* l2 .* f1 .* exp(l2 .* (L - L0)) + 0.1e1 ./ p .^ 2 .* (-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) .* sin(L) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) .* sin(L) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* sin(L) .^ 2 .* l2 .* g1 .* exp(l2 .* (L - L0)) + (0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* h .* sin(L) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* sin(L) .^ 2) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* k .* sin(L) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* sin(L) .* cos(L)) .* l3 .* k1 .* exp(l3 .* (L - L0)) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* sin(L) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* cos(L) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* cos(L) + k .* sin(L)) .* sin(L)) .* sqrt(mu .* p) .* q .^ 2 .* l2 .* g1 .* exp(l2 .* (L - L0)) + 0.1e1 ./ p .^ 2 .* (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) .* h + 0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L) .* l1 .* p1 .* exp(l1 .* (L - L0)) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* sin(L) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* sin(L) .^ 2 .* l2 .* g1 .* exp(l2 .* (L - L0)) + (0.16e2 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (h .* sin(L) - k .* cos(L)) .* (h .^ 2) - 0.8e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* sin(L) .* h - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L))) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (0.16e2 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (h .* sin(L) - k .* cos(L)) .* k .* h - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* sin(L) .* k + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* cos(L) .* h) .* l3 .* k1 .* exp(l3 .* (L - L0)) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* sin(L) .* (-f .* sin(L) + g .* cos(L)) - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* cos(L) + k .* sin(L)) .* h + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L)) .* sqrt(mu .* p) .* q .^ 2 .* l3 .* h1 .* exp(l3 .* (L - L0)) + 0.1e1 ./ p .^ 2 .* (-0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) .* k - 0.2e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L) .* l1 .* p1 .* exp(l1 .* (L - L0)) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) .* k + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* cos(L) .^ 2 .* l2 .* f1 .* exp(l2 .* (L - L0)) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) .* k + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* cos(L) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) + (0.16e2 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (h .* sin(L) - k .* cos(L)) .* k .* h - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* sin(L) .* k + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* cos(L) .* h) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (0.16e2 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 3) .* (h .* sin(L) - k .* cos(L)) .* (k .^ 2) + 0.8e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* cos(L) .* k - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L))) .* l3 .* k1 .* exp(l3 .* (L - L0)) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* k + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* cos(L) .* (-f .* sin(L) + g .* cos(L)) - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* cos(L) + k .* sin(L)) .* k + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L)) .* sqrt(mu .* p) .* q .^ 2 .* l3 .* k1 .* exp(l3 .* (L - L0)) + 0.1e1 ./ p .^ 2 .* (-0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) .* (-f .* sin(L) + g .* cos(L)) + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (0.2e1 .* h .* cos(L) + 0.2e1 .* k .* sin(L)) .* l1 .* p1 .* exp(l1 .* (L - L0)) + 0.1e1 ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-0.2e1 .* k .* cos(L) + 0.2e1 .* h .* sin(L)) .* l1 .^ 2 .* p1 .* exp(l1 .* (L - L0)) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) .* (-f .* sin(L) + g .* cos(L)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* cos(L) + k .* sin(L)) .* cos(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* sin(L) .* l2 .* f1 .* exp(l2 .* (L - L0)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* cos(L) .* l2 .^ 2 .* f1 .* exp(l2 .* (L - L0)) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) .* (-f .* sin(L) + g .* cos(L)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* cos(L) + k .* sin(L)) .* sin(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* cos(L) .* l2 .* g1 .* exp(l2 .* (L - L0)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* sin(L) .* l2 .^ 2 .* g1 .* exp(l2 .* (L - L0)) + (0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* h - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* cos(L) + k .* sin(L)) .* h - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* sin(L) .* (-f .* sin(L) + g .* cos(L)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L)) .* l3 .* h1 .* exp(l3 .* (L - L0)) + (-0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* h + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L)) .* l3 .^ 2 .* h1 .* exp(l3 .* (L - L0)) + (0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .* k - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* cos(L) + k .* sin(L)) .* k + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* cos(L) .* (-f .* sin(L) + g .* cos(L)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* sin(L)) .* l3 .* k1 .* exp(l3 .* (L - L0)) + (-0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ ((h .^ 2 + k .^ 2 + 1) .^ 2) .* (h .* sin(L) - k .* cos(L)) .* k - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* cos(L)) .* l3 .^ 2 .* k1 .* exp(l3 .* (L - L0)) + 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 3 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* (-f .* sin(L) + g .* cos(L)) .^ 2 - 0.4e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* cos(L) + k .* sin(L)) .* (-f .* sin(L) + g .* cos(L)) - 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) .^ 2 ./ (h .^ 2 + k .^ 2 + 1) .* (h .* sin(L) - k .* cos(L)) .* (-f .* cos(L) - g .* sin(L)) + 0.2e1 .* p ./ (0.1e1 + f .* cos(L) + g .* sin(L)) ./ (h .^ 2 + k .^ 2 + 1) .* (-h .* sin(L) + k .* cos(L))) .* sqrt(mu .* p) .* q .^ 2) .* sqrt(mu .* p) .* q .^ 2 ./ p .^ 2;
%         
%         Acc(:,1) =  Accx;
%         Acc(:,2) =  Accy;
%         Acc(:,3) =  Accz;
%         
%     end
    
else
    
    % Finite differences procedure (not accurate)
    % Different versions for the differentiation are written
    % The uncommented ones work fine
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    % Create vector of middle L
    % midL = LVec(1:end-1) + LStep/2;
    
%     % Interpolate postion on equal spaced time vector
     timeVec = linspace(timeVec1(1),timeVec1(end),length(timeVec1));
     timeVec = timeVec';
     n = 1;
     hT = (timeVec(2)-timeVec(1))/n;
%     timeVecT = timeVec + hT;
     for i=1:3
         R(:,i) = spline(timeVec1,Rr(:,i),timeVec);
%         RT(:,i) = spline(timeVec1,Rr(:,i),timeVecT);
     end
%     
%     % Velocity with finite approximation (time derivative)
%     for i=1:3
%         V(:,i) = ( RT(1:end,i) - R(1:end,i) )/hT;
%     end
    
    % Velocity with finite approximation (time derivative)
    %R = Rr;
    %timeVec = timeVec1;
    
    for i=1:3
        V(:,i) = diff(R(:,i))./hT;
        %V(:,i) = ( R(2:end,i) - R(1:end-1,i) )./( timeVec(2:end) - timeVec(1:end-1));
    end

    % Velocity with finite approximation (L derivative)
    % for i=1:3
    %     Vm(:,i) = ( R(2:end,i) - R(1:end-1,i) )./...
    %         ( LVec(2:end) - LVec(1:end-1)).*((LDot(1:end-1) + LDot(2:end) )/2);
    % end
    
    % % Extrapolate V in nodal points (last element already computed)
    % for i=1:3
    %     s = csaps(midL,Vm(:,i));
    %     %s = fnxtr(csaps(midL,Vm(:,i)));
    %     V(:,i) = fnval(s,LVec);
    % end
    
    % Add last element (not available from finite differencing) using different
    % schemes
    
    %V(end+1,:) = ( V(end,:) + V(end-1,:) )/2;
    %V(end+1,:) =  V(end,:);
    V(end+1,:) = V(end,:) + ( V(end,:) - V(end-1,:) );
    
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    % Same thing for acceleration
    
%     for i=1:3
%         VT(:,i) = spline(timeVec1,V(:,i),timeVecT);
%     end
%     
%     % Velocity with finite approximation (time derivative)
%     for i=1:3
%         Acc(:,i) = ( VT(1:end,i) - V(1:end,i) )/hT;
%     end
        
    % Velocity with finite approximation (time derivative)
    for i=1:3
         Acc(:,i) = diff(V(:,i))./hT;
        %Acc(:,i) = ( V(2:end,i) - V(1:end-1,i) )./( timeVec(2:end) - timeVec(1:end-1));
    end
    
    %  Acceleration with finite approximation (L derivative)
    % for i=1:3
    %     Accm(:,i) = ( V(2:end,i) - V(1:end-1,i) )./...
    %         ( LVec(2:end) - LVec(1:end-1)).*((LDot(1:end-1) + LDot(2:end) )/2);
    % end
    
    % % Extrapolate A in nodal points (last element already computed)
    % for i=1:3
    %     s = csaps(midL,Accm(:,i));
    %     %s = fnxtr(csaps(midL,Accm(:,i)));
    %     Acc(:,i) = fnval(s,LVec);
    % end
    
    % Add last element (not available from finite differencing) using different
    % schemes
    
    % Acc(end+1,:) = ( Acc(end,:) + Acc(end-1,:) )/2;
    % Acc(end+1,:) = Acc(end,:);
    Acc(end+1,:) = Acc(end,:) + ( Acc(end,:) - Acc(end-1,:) );
    
    
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%     % Procedure with finite differences of pseudo elements and then from
%     % Gauss equation find the control acceleration
%     %--------------------------------------------------------------------------
%     % Approximate the derivatives of the orbital elements with finite differences
%     %--------------------------------------------------------------------------
%     pDot = ( p(2:end) - p(1:end-1) )./( timeVec(2:end) - timeVec(1:end-1));
%     pDot(end+1,:) = pDot(end,:) + ( pDot(end,:) - pDot(end-1,:) );
%     
%     fDot = ( f(2:end) - f(1:end-1) )./( timeVec(2:end) - timeVec(1:end-1));
%     fDot(end+1,:) = fDot(end,:) + ( fDot(end,:) - fDot(end-1,:) );
%     
%     gDot = ( g(2:end) - g(1:end-1) )./( timeVec(2:end) - timeVec(1:end-1));
%     gDot(end+1,:) = gDot(end,:) + ( gDot(end,:) - gDot(end-1,:) );
%     
%     hDot = ( h(2:end) - h(1:end-1) )./( timeVec(2:end) - timeVec(1:end-1));
%     hDot(end+1,:) = hDot(end,:) + ( hDot(end,:) - hDot(end-1,:) );
%     
%     kDot = ( p(2:end) - k(1:end-1) )./( timeVec(2:end) - timeVec(1:end-1));
%     kDot(end+1,:) = kDot(end,:) + ( kDot(end,:) - kDot(end-1,:) );
%     
%     %--------------------------------------------------------------------------
%     % Calculate the control from the Gauss equations
%     %--------------------------------------------------------------------------
%     At = pDot./(2*sqrt(p/mu).*p./q);
%     s2 = 1 + h.^2 + k.^2;
%     Ah = kDot./(sqrt(p/mu).*s2.*sin(LVec)./(2*q));
%     Ar = (fDot - sqrt(p/mu)./q.*((q+1).*cos(LVec) + f).*At +...
%         sqrt(p/mu).*g./q.*(h.*sin(LVec) -k.*cos(LVec)).*Ah )./(sqrt(p/mu).*sin(LVec));
%  
%     % Modulus
%     AContMod = sqrt( Ar.^2 + At.^2 + Ah.^2 );
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   
    
    
end

%--------------------------------------------------------------------------
% Calculate control acceleration and modulus
%--------------------------------------------------------------------------
for i=1:3
   ACont(:,i) = Acc(:,i) + (mu./RMod.^3).*R(:,i);
end

% Compute modulus
AContMod = sqrt(ACont(:,1).^2 + ACont(:,2).^2 + ACont(:,3).^2);

%--------------------------------------------------------------------------
% Calculate the DeltaV with a Simpson quadrature
%--------------------------------------------------------------------------
DV = (LStep/6)*(AContMod(1)*TPrime(1) + 2*sum(AContMod(3:2:end-1).*TPrime(3:2:end-1)) + ...
      + 4*sum(AContMod(2:2:end-1).*TPrime(2:2:end-1)) + AContMod(end)*TPrime(end));
  
%--------------------------------------------------------------------------
% Set Objective
%--------------------------------------------------------------------------
Objective = DV;

end


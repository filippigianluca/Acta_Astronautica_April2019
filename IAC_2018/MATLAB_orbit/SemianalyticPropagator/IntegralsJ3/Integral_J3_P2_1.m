function I_P2_1 = Integral_J3_P2_1(Eq0, L0, L)


P1 = Eq0(2);
P2 = Eq0(3);
Q1 = Eq0(4);
Q2 = Eq0(5);

G = 1 + Q1^2 + Q2^2;

LL = [L0 L];
   

I_P2_1_temp = LL * ( ...
 (-3).*G.^(-2).*((-5).*P1.*P2.*Q1+Q2+4.*P1.^2.*Q2+(-1).*P2.^2.*Q2) ...
  .*(G.^2+(-5).*(Q1.^2+Q2.^2)) ...
    ) + ...
cos(LL) * ( ...
(-1/16).*G.^(-2).*(6.*G.^2.*(21.*(2+P1.^2).*P2.*Q1+7.*P2.^3.*Q1+( ...
  -1).*P1.*(62+19.*P1.^2).*Q2+(-5).*P1.*P2.^2.*Q2)+5.*((-15).*P1.* ...
  P2.^2.*Q2.*((-11).*Q1.^2+Q2.^2)+(-3).*P2.*Q1.*((88+29.*P1.^2).* ...
  Q1.^2+9.*(8+9.*P1.^2).*Q2.^2)+P1.*Q2.*((408+81.*P1.^2).*Q1.^2+5.*( ...
  72+25.*P1.^2).*Q2.^2)+P2.^3.*((-59).*Q1.^3+9.*Q1.*Q2.^2)))...
) + ...
cos(2*LL) * ( ...
 (1/2).*G.^(-2).*((-3).*G.^2.*((3+4.*P1.^2+5.*P2.^2).*Q1+(-3).*P1.* ...
  P2.*Q2)+5.*Q1.*((10+9.*P1.^2+21.*P2.^2).*Q1.^2+(-36).*P1.*P2.*Q1.* ...
  Q2+3.*(2+7.*P1.^2+(-1).*P2.^2).*Q2.^2))...
) + ...
cos(3*LL) * ( ...
(-1/16).*G.^(-2).*(G.^2.*((68+11.*P1.^2).*P2.*Q1+19.*P2.^3.*Q1+ ...
  P1.*(68+21.*P1.^2).*Q2+5.*P1.*P2.^2.*Q2)+5.*(P1.*P2.^2.*Q2.*(19.* ...
  Q1.^2+(-13).*Q2.^2)+P1.*Q2.*((28+3.*P1.^2).*Q1.^2+(-1).*(100+29.* ...
  P1.^2).*Q2.^2)+P2.^3.*((-33).*Q1.^3+23.*Q1.*Q2.^2)+P2.*((-1).*( ...
  124+25.*P1.^2).*Q1.^3+(100+31.*P1.^2).*Q1.*Q2.^2)))...
) + ...
cos(4*LL) * ( ...
(1/4).*G.^(-2).*(6.*G.^2.*(P1.^2.*Q1+(-1).*P2.^2.*Q1+(-2).*P1.* ...
  P2.*Q2)+(-5).*((-5).*(1+3.*P2.^2).*Q1.^3+(-21).*P1.*P2.*Q1.^2.*Q2+ ...
  3.*(5+8.*P1.^2+7.*P2.^2).*Q1.*Q2.^2+(-9).*P1.*P2.*Q2.^3)) ...
) + ...
cos(5 * LL) * ( ...
(1/16).*G.^(-2).*(3.*G.^2.*(3.*P1.^2.*P2.*Q1+(-1).*P2.^3.*Q1+ ...
  P1.^3.*Q2+(-3).*P1.*P2.^2.*Q2)+3.*P1.*P2.^2.*Q2.*(57.*Q1.^2+Q2.^2) ...
  +(-3).*P2.*Q1.*(((-36)+11.*P1.^2).*Q1.^2+27.*(4+P1.^2).*Q2.^2)+ ...
  P1.*Q2.*((324+51.*P1.^2).*Q1.^2+(-1).*(108+37.*P1.^2).*Q2.^2)+ ...
  P2.^3.*(47.*Q1.^3+(-81).*Q1.*Q2.^2)) ...
) + ...
cos(6 * LL) * ( ...
(-5/2).*G.^(-2).*((-1).*P2.^2.*Q1.*(Q1.^2+(-3).*Q2.^2)+2.*P1.*P2.* ...
  Q2.*((-3).*Q1.^2+Q2.^2)+P1.^2.*(Q1.^3+(-3).*Q1.*Q2.^2))...
) + ...
cos(7 * LL) * ( ...
 (-5/16).*G.^(-2).*(3.*P1.^2.*P2.*Q1.*(Q1.^2+(-3).*Q2.^2)+(-1).* ...
  P2.^3.*Q1.*(Q1.^2+(-3).*Q2.^2)+3.*P1.*P2.^2.*Q2.*((-3).*Q1.^2+ ...
  Q2.^2)+P1.^3.*(3.*Q1.^2.*Q2+(-1).*Q2.^3))...
) + ...
 sin(LL) * ( ...
 (3/16).*G.^(-2).*(2.*G.^2.*(5.*P1.^3.*Q1+P1.*(34+19.*P2.^2).*Q1+( ...
  -7).*P1.^2.*P2.*Q2+7.*P2.*(2+P2.^2).*Q2)+(-5).*((-1).*P1.^2.*P2.* ...
  Q2.*(47.*Q1.^2+3.*Q2.^2)+P1.*Q1.*((72+51.*P2.^2).*Q1.^2+(-1).*(( ...
  -56)+P2.^2).*Q2.^2)+P2.*Q2.*((40+29.*P2.^2).*Q1.^2+3.*(8+3.*P2.^2) ...
  .*Q2.^2)+P1.^3.*(7.*Q1.^3+19.*Q1.*Q2.^2)))...
) + ...
sin(2*LL) * ( ...
 (1/2).*G.^(-2).*(3.*G.^2.*((-1).*P1.*P2.*Q1+6.*P1.^2.*Q2+3.*(1+ ...
  P2.^2).*Q2)+(-5).*(6.*P1.*P2.*Q1.*(Q1.^2+(-5).*Q2.^2)+Q2.*(3.*(4+ ...
  9.*P2.^2).*Q1.^2+(8+3.*P2.^2).*Q2.^2)+3.*P1.^2.*(3.*Q1.^2.*Q2+7.* ...
  Q2.^3))) ...
) + ...
sin(3 * LL) * ( ...
  (1/16).*G.^(-2).*(G.^2.*((-15).*P1.^3.*Q1+(-1).*P1.*(68+23.*P2.^2) ...
  .*Q1+29.*P1.^2.*P2.*Q2+P2.*(68+13.*P2.^2).*Q2)+5.*((-1).*P1.^2.* ...
  P2.*Q2.*(71.*Q1.^2+15.*Q2.^2)+P2.*Q2.*((-1).*(236+55.*P2.^2).* ...
  Q1.^2+((-12)+P2.^2).*Q2.^2)+P1.*Q1.*(3.*(12+5.*P2.^2).*Q1.^2+(164+ ...
  47.*P2.^2).*Q2.^2)+P1.^3.*(7.*Q1.^3+39.*Q1.*Q2.^2)))...
) + ...
sin(4 * LL) * ( ...
 (1/4).*G.^(-2).*((-6).*G.^2.*(2.*P1.*P2.*Q1+P1.^2.*Q2+(-1).* ...
  P2.^2.*Q2)+5.*((-3).*(5+11.*P2.^2).*Q1.^2.*Q2+(5+3.*P2.^2).*Q2.^3+ ...
  12.*P1.^2.*Q2.*((-1).*Q1.^2+Q2.^2)+3.*P1.*P2.*Q1.*(5.*Q1.^2+Q2.^2) ...
  ))...
) + ...
sin(5 * LL) * ( ...
(1/16).*G.^(-2).*(3.*G.^2.*(P1.^3.*Q1+(-3).*P1.*P2.^2.*Q1+(-3).* ...
  P1.^2.*P2.*Q2+P2.^3.*Q2)+3.*P1.*Q1.*((36+29.*P2.^2).*Q1.^2+(-27).* ...
  (4+P2.^2).*Q2.^2)+P2.*Q2.*((-3).*(108+37.*P2.^2).*Q1.^2+(108+17.* ...
  P2.^2).*Q2.^2)+P1.^3.*(7.*Q1.^3+(-81).*Q1.*Q2.^2)+P1.^2.*P2.*(9.* ...
  Q1.^2.*Q2+57.*Q2.^3)) ...
) + ...
sin(6 * LL) * ( ...
(5/2).*G.^(-2).*(2.*P1.*P2.*Q1.*(Q1.^2+(-3).*Q2.^2)+P2.^2.*Q2.*(( ...
  -3).*Q1.^2+Q2.^2)+P1.^2.*(3.*Q1.^2.*Q2+(-1).*Q2.^3)) ...
) + ...
sin(7 * LL) * ( ...
(-5/16).*G.^(-2).*((-3).*P1.*P2.^2.*Q1.*(Q1.^2+(-3).*Q2.^2)+3.* ...
  P1.^2.*P2.*Q2.*((-3).*Q1.^2+Q2.^2)+(-1).*P2.^3.*Q2.*((-3).*Q1.^2+ ...
  Q2.^2)+P1.^3.*(Q1.^3+(-3).*Q1.*Q2.^2)) ...
);


I_P2_1 = I_P2_1_temp(2:end) - I_P2_1_temp(1);



